<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Poker Game</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .game-table { 
      width: 800px; 
      height: 500px; 
      background-color: #007700; 
      border-radius: 50%; 
      margin: 0 auto; 
      position: relative; 
    }
    .controls { text-align: center; margin-top: 20px; }
    button { padding: 10px 20px; margin: 0 10px; }
  </style>
</head>
<body>
  <h1>Poker Game</h1>
  <div class="game-table">
    <!-- Game elements will go here -->
  </div>
  <div class="controls">
    <button onclick="callAction()">Call</button>
    <button onclick="raiseAction()">Raise</button>
    <button onclick="foldAction()">Fold</button>
  </div>
  <div id="messages"></div>
  
  <script>
    const messages = document.getElementById("messages");

    // Listen for messages from parent frame
    window.addEventListener('message', event => {
        if (event.data.type === 'websocket') {
            handleMessage(event.data.data);
        }
    });

    // Send messages through parent using postMessage
    function sendToServer(message) {
        window.parent.postMessage({
            type: 'sendWebSocket',
            data: message
        }, '*');
    }

    // Tell server we're joining the game when page loads
    window.onload = function() {
        sendToServer("game:join");
        messages.innerHTML += "<p>Connected to game server.</p>";
    };

    function handleMessage(data) {
        messages.innerHTML += "<p>Server: " + data + "</p>";
        
        // Listen for redirects if needed
        try {
            if(data.startsWith("redirect:")) {
                const target = data.split(":")[1].trim();
                window.parent.navigate(target);
            }
            
            // Try to parse as JSON if possible
            const jsonData = JSON.parse(data);
            if(jsonData.redirect) {
                window.parent.navigate(jsonData.redirect);
            }
        } catch(e) {
            // Not JSON or other error, ignore
        }
    }

    function callAction() {
        sendToServer("game:call");
    }
    
    function raiseAction() {
        sendToServer("game:raise");
    }
    
    function foldAction() {
        sendToServer("game:fold");
    }
  </script>
</body>
</html>